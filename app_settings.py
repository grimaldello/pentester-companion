from pathlib import Path

######################################
### External Resources
######################################

### Urls
LINPEAS_REPOSITORY_URL = "https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh"
LINENUM_REPOSITORY_URL = "https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh"
WINPEAS_REPOSITORY_URL = "https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/winPEAS/winPEASbat/winPEAS.bat"

### Wordlists
DIRB_BIG = "/usr/share/wordlists/dirb/big.txt"
DIRBUSTER_SMALL = "/usr/share/wordlists/dirbuster/directory-list-2.3-small.txt"


######################################
### Local Resources
######################################

### File System Resources
_BASE_DIR = "/tmp/pentester-companion/"

def _add_path_to_base_dir(path_to_add):
    Path(_BASE_DIR).mkdir(parents=True, exist_ok=True)
    return f"{_BASE_DIR}/{path_to_add}"

def get_command_output_path(request_id):
    return f"{_add_path_to_base_dir(request_id)}.out"

def get_resource_by_file_name(resource_name=""):
    return f"{_add_path_to_base_dir(resource_name)}"

PHP_REVERSE_SHELL_FILE_NAME = "php-reverse.php"
BASH_REVERSE_SHELL_FILE_NAME = "bash-reverse.sh"
SOCAT_REVERSE_SHELL_FILE_NAME = "socat-reverse.sh"
GOLANG_REVERSE_SHELL_FILE_NAME = "golang-reverse.sh"
PHP_CMD_REVERSE_SHELL_FILE_NAME = "php-reverse.sh"

### Urls
_BASE_URL_CLIENT = "/client"
def get_command_output_redirect_url(request_id=""):
    if request_id == None or request_id == "":
        return f"{_BASE_URL_CLIENT}/get-command-output"
    return f"{_BASE_URL_CLIENT}/get-command-output?request_id={request_id}"
    